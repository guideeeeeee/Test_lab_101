# TLS 1.2 Configuration (2019 Standard)
# This configuration represents best practices from 2019

# TLS Protocol Versions
# TLS 1.3 disabled - not widely adopted in 2019
ssl_protocols TLSv1.2;

# Cipher Suites (2019 Mozilla Intermediate compatibility)
# Ordered by preference (strongest first)
ssl_ciphers 'ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256';

# Prefer server ciphers over client
ssl_prefer_server_ciphers on;

# RSA-2048 Certificate and Key
ssl_certificate /etc/nginx/certs/server.crt;
ssl_certificate_key /etc/nginx/certs/server.key;

# Diffie-Hellman parameters for Perfect Forward Secrecy
ssl_dhparam /etc/nginx/certs/dhparam.pem;

# Session Cache
ssl_session_timeout 1d;
ssl_session_cache shared:MozSSL:10m;  # about 40000 sessions
ssl_session_tickets off;

# OCSP Stapling (commented out - requires real CA)
# ssl_stapling on;
# ssl_stapling_verify on;
# ssl_trusted_certificate /etc/nginx/certs/chain.pem;

# Security Headers (2019 best practices)
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;

# HSTS (HTTP Strict Transport Security)
# Commented out for lab purposes - uncomment in production
# add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
