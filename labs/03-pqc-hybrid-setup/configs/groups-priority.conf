# Group Priority Configuration
# การตั้งค่าลำดับความสำคัญของ Groups

# This file demonstrates different strategies for prioritizing
# cryptographic groups in hybrid TLS configurations.
# 
# Include in nginx.conf with:
# include /etc/nginx/configs/groups-priority.conf;

# ============================================
# Strategy 1: PQC-First (Recommended for Testing)
# ============================================
# Prioritize hybrid PQC, fallback to classical
# Use for: Testing, early adopters, high-security environments

# ssl_ecdh_curve x25519_kyber768:x25519_kyber1024:X25519:P-256:P-384;

# Priority order:
# 1. x25519_kyber768    (Hybrid: X25519 + ML-KEM-768, AES-192 equivalent)
# 2. x25519_kyber1024   (Hybrid: X25519 + ML-KEM-1024, AES-256 equivalent)
# 3. X25519             (Classical ECDH, fast, widely supported)
# 4. P-256              (Classical ECDH, NIST standard)
# 5. P-384              (Classical ECDH, higher security)

# Expected behavior:
# - PQC-capable clients use hybrid KEMs
# - Classical clients use X25519 or P-256
# - Maximum compatibility with quantum resistance

# ============================================
# Strategy 2: Balanced (Recommended for Production)
# ============================================
# Classical first for compatibility, hybrid as alternative
# Use for: Production deployments with mixed client base

# ssl_ecdh_curve X25519:x25519_kyber768:P-256:x25519_kyber1024;

# Priority order:
# 1. X25519             (Classical, fastest)
# 2. x25519_kyber768    (Hybrid, if client supports)
# 3. P-256              (Classical fallback)
# 4. x25519_kyber1024   (Hybrid higher security)

# Expected behavior:
# - Most clients use classical (faster)
# - Clients explicitly requesting PQC get hybrid
# - Smooth transition strategy

# ============================================
# Strategy 3: Pure PQC (Future)
# ============================================
# Only post-quantum algorithms
# Use for: Future (2030+), high-security, quantum threat imminent

# ssl_ecdh_curve kyber768:kyber1024:kyber512;

# Priority order:
# 1. kyber768           (Pure ML-KEM-768, AES-192 equivalent)
# 2. kyber1024          (Pure ML-KEM-1024, AES-256 equivalent)
# 3. kyber512           (Pure ML-KEM-512, AES-128 equivalent)

# Expected behavior:
# - Only PQC-capable clients can connect
# - Maximum quantum resistance
# - No classical fallback

# ============================================
# Strategy 4: Maximum Compatibility
# ============================================
# Extensive classical support, hybrid optional
# Use for: Public-facing services, IoT, legacy clients

# ssl_ecdh_curve X25519:P-256:P-384:P-521:x25519_kyber768:p256_kyber768;

# Priority order:
# 1. X25519             (Classical, fastest)
# 2. P-256              (Classical, widely supported)
# 3. P-384              (Classical, higher security)
# 4. P-521              (Classical, highest classical security)
# 5. x25519_kyber768    (Hybrid, if supported)
# 6. p256_kyber768      (Hybrid alternative)

# Expected behavior:
# - Maximum client compatibility
# - PQC available but deprioritized
# - Good for transition period

# ============================================
# Strategy 5: Security-First
# ============================================
# Highest security PQC first, no weak algorithms
# Use for: Financial, government, critical infrastructure

# ssl_ecdh_curve x25519_kyber1024:kyber1024:x25519_kyber768:X25519;

# Priority order:
# 1. x25519_kyber1024   (Hybrid, highest security)
# 2. kyber1024          (Pure PQC, highest security)
# 3. x25519_kyber768    (Hybrid, balanced)
# 4. X25519             (Classical minimum)

# No P-256 (considered weaker by some)
# No P-384/P-521 (slower without security benefit over X25519)
# No kyber512 (lower security)

# ============================================
# Strategy 6: P-256 Based Hybrid
# ============================================
# Use P-256 instead of X25519 for hybrid
# Use for: NIST/FIPS compliance requirements

# ssl_ecdh_curve p256_kyber768:p384_kyber1024:P-256:P-384;

# Priority order:
# 1. p256_kyber768      (Hybrid with P-256)
# 2. p384_kyber1024     (Hybrid with P-384, highest security)
# 3. P-256              (Classical NIST)
# 4. P-384              (Classical NIST higher security)

# Expected behavior:
# - FIPS-compliant curve selection
# - Slower than X25519 but compliant
# - Government/enterprise friendly

# ============================================
# Strategy 7: Progressive Migration
# ============================================
# Gradual shift from classical to hybrid over time
# Use for: Large-scale deployments with phased rollout

## Phase 1: Classical only (baseline)
# ssl_ecdh_curve X25519:P-256;

## Phase 2: Add hybrid support (current)
# ssl_ecdh_curve X25519:x25519_kyber768:P-256;

## Phase 3: Prefer hybrid (next 6 months)
# ssl_ecdh_curve x25519_kyber768:X25519:kyber768:P-256;

## Phase 4: PQC-first (next 1-2 years)
# ssl_ecdh_curve kyber768:x25519_kyber768:X25519;

## Phase 5: Pure PQC (future)
# ssl_ecdh_curve kyber768:kyber1024;

# ============================================
# Testing Configurations
# ============================================

## Test 1: Force hybrid only (testing)
# ssl_ecdh_curve x25519_kyber768;

## Test 2: Force pure PQC (testing)
# ssl_ecdh_curve kyber768;

## Test 3: Force classical only (baseline comparison)
# ssl_ecdh_curve X25519;

# ============================================
# Performance Considerations
# ============================================
#
# Algorithm performance (approximate):
# 
# | Algorithm         | Handshake Time | Key Size | Notes          |
# |-------------------|----------------|----------|----------------|
# | X25519            | 1x             | 32 bytes | Baseline       |
# | P-256             | 1.5x           | 64 bytes | NIST           |
# | P-384             | 2x             | 96 bytes | Slower         |
# | x25519_kyber768   | 2.5x           | 1216 B   | Recommended    |
# | x25519_kyber1024  | 3x             | 1568 B   | High security  |
# | kyber768          | 2x             | 1088 B   | Pure PQC       |
# | p256_kyber768     | 3x             | 1248 B   | FIPS-friendly  |

# ============================================
# Security Considerations
# ============================================
#
# Security levels (classical attack complexity):
#
# | Algorithm         | Classical | Quantum | Status           |
# |-------------------|-----------|---------|------------------|
# | X25519            | 2^128     | 2^64    | Quantum-broken   |
# | P-256             | 2^128     | 2^64    | Quantum-broken   |
# | P-384             | 2^192     | 2^96    | Quantum-broken   |
# | kyber512          | 2^128     | 2^128   | Quantum-safe     |
# | kyber768          | 2^192     | 2^192   | Quantum-safe ✅  |
# | kyber1024         | 2^256     | 2^256   | Quantum-safe     |
# | x25519_kyber768   | 2^192*    | 2^192*  | Hybrid safe ✅   |
#
# * Security is MAX(classical_security, pqc_security) for hybrid

# ============================================
# Compatibility Matrix
# ============================================
#
# Client support (as of 2024):
#
# | Client            | X25519 | x25519_kyber768 | kyber768 |
# |-------------------|--------|-----------------|----------|
# | OpenSSL 3.2+OQS   | ✅     | ✅              | ✅       |
# | Chrome 116+ (exp) | ✅     | ✅              | ❌       |
# | Firefox (exp)     | ✅     | ✅              | ❌       |
# | curl+oqs          | ✅     | ✅              | ✅       |
# | wget              | ✅     | ❌              | ❌       |
# | Java 11+          | ✅     | ❌              | ❌       |
# | Python requests   | ✅     | ❌              | ❌       |
# 
# Always include classical fallback!

# ============================================
# Recommended Configuration
# ============================================
# For most users (2024-2026), use Strategy 2: Balanced

ssl_ecdh_curve X25519:x25519_kyber768:P-256;

# This provides:
# ✅ Fast performance (X25519 first)
# ✅ PQC option (x25519_kyber768)
# ✅ Maximum compatibility (P-256 fallback)
# ✅ Smooth migration path
# ✅ Production-ready
